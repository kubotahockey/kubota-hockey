{% extends "base.html" %}

{% block title %}
Current Year Player Stats - KUBOTA HOCKEY
{% endblock %}

{% block content %}
<div class="container">
    <h1 class="text-center mb-4">Player Full Season Stats</h1>

    <!-- Instructions Section -->
    <div class="instructions-section bg-dark text-light p-4 mb-4 rounded">
        <h5 class="mb-3" style="text-decoration: underline; color: #00e676;">Instructions</h5>
        <p><strong>Points League:</strong> Adjust the scoring settings to reflect your league's point system. The "Fantasy Points" will be calculated based on these settings.</p>
        <p><strong>Categories League:</strong> The scoring settings allow you to include or exclude categories by setting them to 1 (include) or 0 (exclude). The player's total value is calculated based on how much they exceed or fall below the league average in these categories.</p>
        <p><strong>Games Played Settings:</strong></p>
        <ul>
            <li><strong>82 Games:</strong> Assumes every player will play the full season (82 games), putting everyone on the same level.</li>
            <li><strong>GP Projection):</strong> Considers historical missed games and injuries, providing a more cautious projection for each player.</li>
        </ul>
    </div>
    
    <form id="scoring-settings-form" class="mb-4">
        <!-- First Row: Season Length and League Type -->
        <div class="form-row">
            <div class="form-group col-sm-6 col-lg-2">
                <label for="season-length">Season</label>
                <select class="form-control" id="season-length" name="season_length">
                    <option value="82">82</option>
                    <option value="GPNEW">GP Projection</option>
                </select>
            </div>
            <div class="form-group col-sm-6 col-lg-2">
                <label for="league-type">League Type</label>
                <select class="form-control" id="league-type" name="league_type">
                    <option value="points">Points</option>
                    <option value="categories">Categories</option>
                </select>
            </div>
        </div>

        <!-- Roster Inputs Section -->
        <h5 class="text-center mb-3">Roster Settings</h5>
        <div class="form-row">
            <div class="form-group col-sm-6 col-md-4 col-lg-2">
                <label for="lw-starters">LW Starters:</label>
                <input type="number" class="form-control" id="lw-starters" name="lw_starters" value="2" min="0">
            </div>
            <div class="form-group col-sm-6 col-md-4 col-lg-2">
                <label for="rw-starters">RW Starters:</label>
                <input type="number" class="form-control" id="rw-starters" name="rw_starters" value="2" min="0">
            </div>
            <div class="form-group col-sm-6 col-md-4 col-lg-2">
                <label for="c-starters">C Starters:</label>
                <input type="number" class="form-control" id="c-starters" name="c_starters" value="2" min="0">
            </div>
            <div class="form-group col-sm-6 col-md-4 col-lg-2">
                <label for="d-starters">D Starters:</label>
                <input type="number" class="form-control" id="d-starters" name="d_starters" value="4" min="0">
            </div>
            <div class="form-group col-sm-6 col-md-4 col-lg-2">
                <label for="bench">Bench:</label>
                <input type="number" class="form-control" id="bench" name="bench" value="4" min="0">
            </div>
            <div class="form-group col-sm-6 col-md-4 col-lg-2">
                <label for="competitors">Competitors:</label>
                <input type="number" class="form-control" id="competitors" name="competitors" value="10" min="2">
            </div>
        </div>

        <!-- Scoring Settings Section -->
        <h5 class="text-center mb-3">Scoring Settings</h5>
        <div class="form-row">
            <div class="form-group col">
                <label for="g-points">G</label>
                <input type="number" class="form-control scoring-input" id="g-points" name="g_points" value="1" step="any">
            </div>
            <div class="form-group col">
                <label for="a-points">A</label>
                <input type="number" class="form-control scoring-input" id="a-points" name="a_points" value="1" step="any">
            </div>
            <div class="form-group col">
                <label for="sog-points">SOG</label>
                <input type="number" class="form-control scoring-input" id="sog-points" name="sog_points" value="0.5" step="any">
            </div>
            <div class="form-group col">
                <label for="pim-points">PIM</label>
                <input type="number" class="form-control scoring-input" id="pim-points" name="pim_points" value="0.1" step="any">
            </div>
            <div class="form-group col">
                <label for="plusminus-points">+/-</label>
                <input type="number" class="form-control scoring-input" id="plusminus-points" name="plusminus_points" value="0.5" step="any">
            </div>
            <div class="form-group col">
                <label for="ppg-points">PPG</label>
                <input type="number" class="form-control scoring-input" id="ppg-points" name="ppg_points" value="0.5" step="any">
            </div>
            <div class="form-group col">
                <label for="ppa-points">PPA</label>
                <input type="number" class="form-control scoring-input" id="ppa-points" name="ppa_points" value="0.5" step="any">
            </div>
            <div class="form-group col">
                <label for="shg-points">SHG</label>
                <input type="number" class="form-control scoring-input" id="shg-points" name="shg_points" value="1" step="any">
            </div>
            <div class="form-group col">
                <label for="sha-points">SHA</label>
                <input type="number" class="form-control scoring-input" id="sha-points" name="sha_points" value="1" step="any">
            </div>
            <div class="form-group col">
                <label for="blk-points">BLK</label>
                <input type="number" class="form-control scoring-input" id="blk-points" name="blk_points" value="0.5" step="any">
            </div>
            <div class="form-group col">
                <label for="hit-points">HIT</label>
                <input type="number" class="form-control scoring-input" id="hit-points" name="hit_points" value="0.5" step="any">
            </div>
            <div class="form-group col">
                <label for="fol-points">FOL</label>
                <input type="number" class="form-control scoring-input" id="fol-points" name="fol_points" value="-0.1" step="any">
            </div>
            <div class="form-group col">
                <label for="fow-points">FOW</label>
                <input type="number" class="form-control scoring-input" id="fow-points" name="fow_points" value="0.1" step="any">
            </div>
        </div>
        
        <!-- Buttons -->
        <div class="form-row mt-4">
            <div class="col">
                <button type="submit" class="btn btn-primary">Calculate Fantasy Points</button>
                <button id="export-csv" type="button" class="btn btn-primary ml-2">Export to CSV</button>
            </div>
        </div>
    </form>

    <!-- Table for displaying results -->
    <div id="player-data" class="table-responsive">
        <table class="table table-hover table-custom">
            <thead>
                <tr>
                    <th>Player</th>
                    <th>Team</th>
                    <th>Position</th>
                    <th>GP</th>
                    <th>G</th>
                    <th>A</th>
                    <th>PTS</th>
                    <th>SOG</th>
                    <th>PIM</th>
                    <th>+/-</th>
                    <th>PPG</th>
                    <th>PPA</th>
                    <th>SHG</th>
                    <th>SHA</th>
                    <th>BLK</th>
                    <th>HIT</th>
                    <th>FOL</th>
                    <th>FOW</th>
                    <th>Fantasy Points</th>
                </tr>
            </thead>
            <tbody id="table-body">
                <!-- The rows will be injected here by the Flask route -->
            </tbody>
        </table>
    </div>
</div>


{% endblock %}
